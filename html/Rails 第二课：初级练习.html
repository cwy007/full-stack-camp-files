
<style>
  .frame {
      margin-left: 30px;
      margin-right: 30px;
  }

  h1, h2, h3, h4, h5, h6 {
      font-weight: normal;
  }

  .view-count {
      float: right;
      margin-top: -54px;
      color: #9B9B9B;
  }

  .markdown h2, .markdown h3, .markdown h4 {
      text-align: left;
      font-weight: 800;
      font-size: 16px !important;
      line-height: 100%;
      margin: 0;
      color: #555;
      margin-top: 16px;
      margin-bottom: 16px;
      border-bottom: 1px solid #eee;
      padding-bottom: 5px;
  }

    .markdown .figure-code figcaption {
      background-color: #e6e6e6;

      font: 100%/2.25 Monaco, Menlo, Consolas, 'Courier New', monospace;
      text-indent: 10.5px;

      -moz-border-radius: 0.25em 0.25em 0 0;
      -webkit-border-radius: 0.25em;
      border-radius: 0.25em 0.25em 0 0;
      -moz-box-shadow: inset 0 0 0 1px #d9d9d9;
      -webkit-box-shadow: inset 0 0 0 1px #d9d9d9;
      box-shadow: inset 0 0 0 1px #d9d9d9;
  }

  .markdown {
      position: relative;
      line-height: 1.8em;
      font-size: 14px;
      text-overflow: ellipsis;
      word-wrap: break-word;
      font-family: 'PT Serif', Georgia, Times, 'Times New Roman', serif !important;
  }

  .markdown ol li, .markdown ul li {
      line-height: 1.6em;
      padding: 2px 0;
      color: #333;
      font-size: 16px;
  }

  .markdown .figure-code {
      margin: 20px 0;
  }

  .post-content {
      padding-top: 5px;
      padding-bottom: 5px;
  }

  .markdown code {
      background-color: #ececec;
      color: #d14;
      font-size: 85%;
      text-shadow: 0 1px 0 rgba(255,255,255,0.9);
      border: 1px solid #d9d9d9;
      padding: 0.15em 0.3em;
  }

  div {
      display: block;
  }

  .markdown figure.code pre {
      background-color: #ffffcc !important;
  }

  .code .gi {
      color: #859900;
      line-height: 1.2em;
  }

  .code .err {
      color: #93A1A1;
  }

  .markdown a:link, .markdown a:visited {
      color: #0069D6 !important;
      text-decoration: none !important;
  }

  .markdown p {
      font-size: 16px;
      line-height: 1.5em;
  }

  .markdown blockquote {
      margin-left: 0 !important;
      margin-right: 0 !important;
      padding: 12px;
      border-left: 5px solid #50AF51;
      background-color: #F3F8F3;
      clear: both;
      display: block;
  }

  .markdown blockquote>*:first-child {
      margin-top: 0 !important;
  }

  .markdown blockquote>*:last-child {
      margin-bottom: 0 !important;
  }

  .markdown blockquote p {
      color: #222;
  }

  * {
      outline: none !important;
  }

  a:active, a:hover, a:link, a:visited {
      text-decoration: none;
  }

  pre {
      margin: 0;
  }

  .markdown img {
      vertical-align: top;
      max-width:100%;
      height:auto;
  }

  h1 a {
    color: #071A52;
  }

  h4 {
    color: #734488;
  }

  hr {
    border-color: #DEDEDE;
    border-width: 0.8px;
    margin-bottom: auto;
  }

  .end {
    height: 400px;
  }

  .end img {
    clear: both;
    display: block;
    margin: 10px auto;
  }

  .end p {
    text-align: center;
    font-size: 2.5em;
    margin: 60px auto 100px;
    color: #ddd;
  }
</style>
<div class='frame'><h1>
      1-0 由此开始：学习说明
    </h1><h4>所属章节：1- 教材介绍</h4><hr><div class="post group">
    <div class="post-content markdown">
      <p>欢迎进入课程，本网站用户分为免费会员和 VIP 会员。</p>

<p>免费会员可以学习免费课程。</p>

<p>VIP 会员在会员有效期内可以学习所有开课内容，并可享有 Slack 上专业程序员助教团队的技术指导、答疑，另外还有各界大牛不定期直播分享，帮助 VIP 会员更好的成长。</p>
<h3>课程提醒</h3>
<p>继续阅读前请设置<a href="http://docs.qzy.camp/docs/internet" target="_blank">科学上网</a>，不然教材里的图片可能无法正常显示。</p>

<p>我们为每一位 VIP 会员准备了科学上网礼包 ，<a href="https://fullstack.xinshengdaxue.com/account/vip_gifts" target="_blank">点击查看</a>。</p>

<p>如果在注册各种帐号的时候遇到不懂操作的地方，请查阅<a href="http://docs.qzy.camp/docs/courses1" target="_blank">课程帮助文档</a>。</p>

<p>VIP会员请务必在正式开课前完成课前作业，即： 《Rails 第一课》、《Rails 第二课》、《Rails 第三课》的作业。</p>

    </div>
  </div></div><div class='frame'><h1>
      1-1 前言
    </h1><h4>所属章节：1- 教材介绍</h4><hr><div class="post group">
    <div class="post-content markdown">
      <h3>目标</h3>
<p>为了让你用最快的速度上手 Ruby on Rails，我们会使用“真实世界”的范例。</p>

<p>现在我们要实际做出一个投票系统， 这是一个基本可用的程式，让使用者可以：</p>

<ul>
<li>检视主题，用投票数来排序</li>
<li>对主题投票</li>
<li>开新主题、编辑主题、删除主题</li>
<li>贴张图让你看看它会长怎样：</li>
</ul>

<p><figure><img src="https://cdn.filepicker.io/api/file/sV3eQ7djRmOOqyTYGE3n" title=""></figure></p>

<p>(这份教材是基于 RailsBridge 工作坊的 <a href="http://docs.railsbridge.org/intro-to-rails/" target="_blank"> Intro to Rails</a>改编）</p>
<h3>练功目标</h3>
<p>将初级作业完成之后，你会学会：</p>

<ul>
<li>基本 Ruby 语法</li>
<li>要怎么试一些 Ruby 程式码 (irb)</li>
<li>要怎么把需求变成会动的 Rails 应用程式</li>
<li>要怎么把你的应用程式放到网路上</li>
<li>Rails 工程师会使用的基本工具（版本控制、编辑器、console、本机 server）</li>
</ul>
<h3>时程</h3>
<ul>
<li>约 1 小时 Ruby</li>
<li>约 4-6小时 Rails。</li>
</ul>
<h3>需求</h3>
<p>我们会用这些来做：</p>

<ul>
<li>ruby 2.1.2 、2.2.0 、2.3.1用 RVM 安装（Mac 或 Linux）</li>
<li>rails 5.0.0</li>
<li>bundler</li>
<li>Atom编辑器</li>
</ul>

<p>这些应该都要在前一份教材就装好，确定它们都妥妥的。</p>
<h3>如何确认一切没问题？</h3>
<p>运行终端机，输入：</p>

<p><code>irb</code></p>

<p>2.3.1 :001 &gt; <code>1 + 2</code><br>
=&gt; 3</p>

<p>2.3.1 :002 &gt; <code>require "active_support"</code><br>
=&gt; true</p>

<p>2.3.1 :003 &gt; <code>exit</code></p>

<p>这些都可以成功执行的话，就是没问题了。</p>

<p>提示：在 irb 里运行命令的最后记得输入 <code>exit</code> 退出。</p>
<h3>效能！效率！</h3>
<p>我非常推荐你这样做：</p>

<ul>
<li>打开终端机并开两个标签页：

<ul>
<li>一个放着跑 rails s<br>
</li>
<li>一个用来做平常的终端机指令<br>
（有时会用来使用 irb —— 即 rails console，我们之后会提到，用过后记得输入exit退出即可）</li>
</ul>
</li>
<li>重新打开你的浏览器，或是把其他窗口关掉

<ul>
<li>打开新的窗口并开两个标签页</li>
<li>一个用来看本教学</li>
<li>一个用来测试你的程式</li>
</ul>
</li>
<li>打开Atom编辑器，然后不要关掉它。我们不会中途离开。</li>
<li>把其他应用程式都隐藏起来，关掉 Twitter 、即时通讯程式、别的干扰物。</li>
<li>把跟你互动的东西最少化，可以减少你分心在这些东西的次数与耗费的时间（比方说在浏览器里打开 50 个分页，这会干扰到你并且浪费你的时间）</li>
</ul>
<h3>格式</h3>
<p>每一课的格式都会长这样：</p>

<ul>
<li>目标</li>
</ul>

<p>叙述我们要做什么。</p>

<ul>
<li>步骤</li>
</ul>

<p>跟着做，但是这时候你还不知道原理。</p>

<ul>
<li>解释</li>
</ul>

<p>关于这些步骤实际上做了什么的细节，详述原因与效果。将一切都连在一起。</p>
<h3>注意</h3>
<p>如果你刚刚完成第一课的环境建置</p>

<ol>
<li>请在终端机运行 rails server 的窗口（或者标签页）中按 ctrl + c 终止运行，然后按 command + q 退出终端机。</li>
<li>请在 Atom 编辑器的界面按 command + w 关闭所有的标签页，然后点击任务栏左上角 Atom &gt; Quit 退出编辑器。</li>
</ol>

    </div>
  </div></div><div class='frame'><h1>
      2-1 基础 Ruby
    </h1><h4>所属章节：2-Ruby 程式语言</h4><hr><div class="post group">
    <div class="post-content markdown">
      <h3>目标：</h3>
<ul>
<li>会使用 Ruby 基本的语法</li>
<li>用 IRB 跑 Ruby 程式</li>
<li>做简单的算术</li>
<li>使用、了解 Variable（变数）</li>
<li>使用、了解 Array（阵列）</li>
<li>使用 Loop（回圈）和条件判断</li>
</ul>
<h3>步骤</h3>
<p><br></p>
<h4>步骤 1</h4>
<p>在终端机打这些字来启动 IRB（Interactive Ruby Shell），这个程式可以让你试一些 Ruby 程式码：</p>

<p><code>irb</code></p>

<p>长得像这样（你看到的或许会有些不同）：</p>

<figure class="figure-code code"><div class="highlight"><pre>2.3.1 :001 &gt; 
</pre></div>
</figure>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/1HWHe1kuSi2tSL4DBOGK_Screenshot%20at%20Mar%2027%2019-56-32.png" title=""></figure></p>

<p><br></p>
<h4>步骤 2</h4>
<p>接着试一些 Ruby 内建的简单算术。在 IRB 里面打字：</p>

<p><code>3 + 3</code><br>
=&gt; 6</p>

<p><code>7 * 6</code><br>
=&gt; 42</p>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/2H67OWL5SM2PkjFKyKeM_Screenshot%20at%20Mar%2027%2019-57-36.png" title=""></figure><br>
<br></p>
<h4>步骤 3</h4>
<p>Variables（变数） 指的是一个被指定 values（值）的名字。</p>

<p><code>my_variable = 5</code><br>
这会把 5 这个值指定给 my_variable 这个名字。<br>
<br></p>
<h4>步骤 4</h4>
<p>也可以对变数做算术：</p>

<p><code>my_variable + 2</code><br>
=&gt;7</p>

<p><code>my_variable * 3</code><br>
=&gt;15</p>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/dEI7aox8TvyUXc77nmbZ_Screenshot%20at%20Mar%2027%2019-58-55.png" title=""></figure></p>

<p><br></p>
<h4>步骤 5</h4>
<p>变数可以放多个值，这叫 Array（阵列）。</p>

<p><code>fruits = ["kiwi", "strawberry", "plum"]</code></p>

<p>这里我们用了 fruits 这个变数来放一群水果名。</p>

<p><br></p>
<h4>步骤 6</h4>
<p>在终端机打这些字：</p>

<p><code>fruits = fruits + ["orange"]</code><br>
<code>fruits = fruits - ["kiwi"]</code></p>

<ul>
<li>+ 和 - 叫做 Operators（运算符号）。跟数字一样，我们也可以把它们用在 array 上。</li>
</ul>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/JYyWIck3Qh6TQWtJyFh0_Screenshot%20at%20Mar%2027%2020-00-26.png" title=""></figure></p>

<p><br></p>
<h4>步骤 7</h4>
<p>在 Ruby 里面，万物皆有 class （类别）。请在 IRB 里面打字：</p>

<p><code>7.class</code><br>
<code>"kiwi".class</code><br>
<code>fruits.class</code><br>
这些就是我们至今介绍的三个资料型态：<strong>Fixnum（数值）</strong>、<strong>String（文字）</strong>、<strong>Array（列表）</strong>。</p>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/4MDA1Gi1RE6aeE3h5OQh_Screenshot%20at%20Mar%2027%2020-01-36.png" title=""></figure></p>

<p><br></p>
<h4>步骤 8</h4>
<p>每个 class 都有不同的 <strong>method （方法）</strong>可以在该 class 的 <strong>instance （实例）</strong>使用</p>

<p><code>fruits.length</code><br>
<code>fruits.first</code></p>

<p>你可以看看一个 object 所拥有的所有 method：</p>

<p><code>fruits.methods</code></p>

<p>还可以串在一起：</p>

<p><code>fruits.methods.sort</code></p>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/kJvz5kkMSoaNw4Bm70WA_Screenshot%20at%20Mar%2027%2020-02-42.png" title=""></figure></p>

<p><br></p>
<h4>步骤 9</h4>
<p>Array 有个 method 叫做 <strong>each</strong>，会遍历它里面每一个项目并执行程式。</p>

<p><code>fruits.each do |fruit|</code><br>
<code>puts fruit</code><br>
<code>end</code></p>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/qZIuscyaSfhDV4b1gmrr_Screenshot%20at%20Mar%2027%2020-03-45.png" title=""></figure></p>

<p>这会把 fruits array 里面的第一项（"strawberry"）拿出来，把它设给绝对值符号中的 fruit 变数，并执行 do 和 end 之间的程式。然后对其他项重覆做这件事。上面这段程式会印出水果的列表。</p>

<p><br></p>
<h4>步骤 10</h4>
<p><strong>conditional（条件式）</strong> 只会在条件满足的时候才执行程式。</p>

<p><code>if my_variable &gt; 1</code><br>
<code>puts "YAY!"</code><br>
<code>end</code></p>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/gx1pxq6S8iOgNnumfMR7_Screenshot%20at%20Mar%2027%2020-04-52.png" title=""></figure></p>

<p>如果 my_variable 变数里面储存的值大于 1，才会印出 YAY!。</p>

<p>请试着把 <code>&gt;</code> 改成 <code>&lt;</code>。</p>

<p><br></p>
<h4>步骤 11</h4>
<p>你也可以做自己的 method：</p>

<p><code>def pluralize(word)</code><br>
<code>word + "s"</code><br>
<code>end</code><br>
<code>pluralize("kiwi")</code></p>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/FAF8WY2SMWSWTGc2ROfz_Screenshot%20at%20Mar%2027%2020-05-48.png" title=""></figure></p>

<p>Method 会取 <strong>parameters（参数）</strong>，表示它们要对哪些变数操作。以此例而言，我们做了一个 method 叫做 pluralize ，它取一个参数 word，是一个单字。</p>

<p>Method 也可以 return（回传）资料。以此例而言，pluralize 会回传 word 单字加上 's' 结尾。在 Ruby 里面，method 会回传最后一行的结果，无论该结果是什么。</p>

<p><br></p>
<h4>步骤 12</h4>
<p>离开IRB<br>
输入 <code>exit</code> 然后回车即可！</p>

    </div>
  </div></div><div class='frame'><h1>
      3-1 开始吧！
    </h1><h4>所属章节：3-初探 Rails</h4><hr><div class="post group">
    <div class="post-content markdown">
      <p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/5bhXugJ7Rbup5tk8iCin_Start_page.png" title=""></figure></p>
<h3>目标</h3>
<p>建立你的 New Application</p>

<p>来，开始吧！在这一步骤的最后，我们会得到一个全新的（空白）Rails 应用程式。</p>
<h3>步骤</h3>
<p><br></p>
<h4>步骤 1</h4>
<p>cd 的意思是切换目录（<strong>C</strong>hange <strong>D</strong>irectory）</p>

<p>在终端机打这些字 ( Mac 或 Linux )</p>

<p><code>cd ~</code><br>
cd ~ 切换（当前位置）到home目录</p>

<p><br></p>
<h4>步骤 2</h4>
<p>在终端机打这些字：</p>

<p><code>mkdir railsbridge</code></p>

<p>这会新增一个资料夹，让我们把专案放在里面。</p>

<p><br></p>
<h4>步骤 3</h4>
<p>在终端机打这些字：</p>

<p><code>cd railsbridge</code></p>

<p><br></p>
<h4>步骤 4</h4>
<p>确定一下你有没有之前练习用的程式码在里面。</p>

<p>在终端机打这些字：</p>

<p><code>ls</code></p>

<p>这指令会列出 railsbridge 资料夹里面的档案。如果列出了旧的 suggestotron 应用程式，你可以删掉它们来避免干扰：</p>

<p>在终端机打这些字：</p>

<p><code>rm -rf suggestotron</code></p>

<p><br></p>
<h4>步骤 5</h4>
<p>在终端机打这些字：</p>

<p><code>rails new suggestotron</code></p>

<p>rails new 会用你给的名字来建立新的 Rails 专案</p>

<p>这次我们建一个新的专案叫 suggestotron 。我们马上就会详述它到底建立了什么。</p>

<p><br></p>
<h4>步骤 6</h4>
<p>在终端机打这些字：</p>

<p><code>cd suggestotron</code></p>

<p>cd 指的是切换目录 (<strong>c</strong>hange <strong>d</strong>irectory)。</p>

<p>cd suggestotron 切换到 suggestotron 做为成当前资料夹。</p>

<p><br></p>
<h4>步骤 7</h4>
<p>在终端机打这些字：</p>

<p><code>ls</code></p>

<p>ls 指的是列出东西 (<strong>l</strong>ist <strong>s</strong>tuff)。</p>

<p>它会把目前资料夹的内容列出来给你看。</p>

<p><br></p>
<h4>步骤 8</h4>
<p>运行 Atom 编辑器，用专案的方式打开 suggestotron 资料夹。</p>

<p>选择 File &gt; Add Project Folder...。</p>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/VK95IFVJSDCcllQJNKhf_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-10%20%E4%B8%8B%E5%8D%889.43.28.png" title=""></figure></p>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/UjXTgjYnRhe1OlNPUl92_finder.png" title=""></figure></p>

<p>在右上角输入suggestotron，电脑会找到这给资料夹，点击选择它，如果一切没问题的话，Atom 会在视窗左边以树状结构列出资料夹的内容：</p>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/BMH6RhzoTXqDKA3JpvMm_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-10%20%E4%B8%8B%E5%8D%889.46.16.png" title=""></figure></p>

<p>你会发现 rails new 开了一大堆资料夹和档案。今天我们要看的是这些：</p>

<p>（<strong>档案/资料夹 ：</strong>用途 ）</p>

<p><strong>app/：</strong> 包含你应用程式的 controllers、models、views。你要改的东西大多是这些。 </p>

<p><strong>config/：</strong> 设定应用程式的执行阶段规则、路由设定（routes）、资料库等等。</p>

<p><strong>db/：</strong>显示你目前资料库的 schema（结构定义），以及资料库的 migrations。</p>

<p><strong>public/：</strong>这是唯一一个资料夹会是放什么就出现什么的。如果你把档案放里面，server 会直接回传，不会经过 Rails 的处理。</p>

<p><strong>app/assets/：</strong>你会要把图片、JavaScript、stylesheets (CSS) 还有其他静态档案放在里面。现代的 Rails 应用程式使用一种叫做 Assets Pipeline 的东西，把在这资料夹里面的所有 JavaScript 和 CSS 档合并成一个档案来加速。</p>

<p>rails new 还建立了其他很多东西。大概可以写一本书来讲，所以我们现在先无视它们。</p>

    </div>
  </div></div><div class='frame'><h1>
      3-2 把专案加进 Git Repo
    </h1><h4>所属章节：3-初探 Rails</h4><hr><div class="post group">
    <div class="post-content markdown">
      <h3>目标</h3>
<ul>
<li>建一个本地的 git repository（仓库）</li>
<li>把所有档案加入 git repository</li>
</ul>

<p>为了把我们的应用程式发布到网络上，我们要把我们的程式和过程中的修改都加到“版本控制系统”。我们会用 git ，因为它比较简单，而且 Heroku 也用它。</p>

<p><br></p>
<h3>步骤</h3>
<h4>步骤 1</h4>
<p>请用<code>pwd</code>确认你在suggestotron目录里。</p>

<p>在终端机打这些字：</p>

<p><code>git init</code><br>
<figure><img src="http://ww2.sinaimg.cn/large/006y8lVajw1faqwyyi527j30km02jgmx.jpg" title=""></figure></p>

<p>跑完之后它看起来没有做什么事，然而事实上 git init 已经把 repository（repo）初始化到一个叫做 .git 的资料夹。 你可以打 ls -a（列出所有档案）来看到它。</p>

<p><br></p>
<h4>步骤 2</h4>
<p>在终端机打这些字：</p>

<p><code>git status</code></p>

<p><figure><img src="http://ww4.sinaimg.cn/large/006y8lVajw1faqx0ddc70j30j80dhjtp.jpg" title=""></figure></p>

<p>git status 会告诉你 git 所见所有改过、新增、删掉的东西。</p>

<p>第一次跑这个指令的时候，会看到很多东西。</p>

<p>第二次跑这个指令的时候，你不会看到很多东西。</p>

<p><br></p>
<h4>步骤 3</h4>
<p>在终端机打这些字：</p>

<p><code>git add .</code></p>

<p>git add . 告诉 git 你想要把目前资料夹（即 .）还有它底下的所有东西加进 repo。</p>

<p>在 Git 里，有多个指令可以做到类似的事：</p>

<ul>
<li>
<code>git add foo.txt</code> 把名叫 foo.txt 的档案加进追踪修订。</li>
<li>
<code>git add . ("git add dot")</code> 把所有新档案和改过的档案加进追踪修订，但“保留”你删掉的档案。</li>
<li>
<code>git add -A</code> 全部加进追踪修订，包括删掉的档案。</li>
</ul>

<p>“把删掉的档案加进来”听起来很奇怪，但如果你把版本控制系统想像成是追踪“修改”的工具，或许就会懂了。 多数人用 git add . 但 git add -A 会比较安全。无论如何，git status 都能帮上你的忙。</p>

<p><br></p>
<h4>步骤 4</h4>
<p>在终端机打这些字：</p>

<p><code>git commit -m "Added all the things"</code></p>

<p><figure><img src="http://ww1.sinaimg.cn/large/006y8lVajw1faqx0z5fmjj30il071jup.jpg" title=""></figure></p>

<p>git commit 告诉 git 真的要执行你叫它做的事。</p>

<p>分成 add 和 commit 两个步骤的好处是，如此你就可以把多个修改合并在一起。</p>

<p>-m "Added all the things 这个捷径让你可以直接写下 commit message。</p>

    </div>
  </div></div><div class='frame'><h1>
      3-3 在本机执行你的程式
    </h1><h4>所属章节：3-初探 Rails</h4><hr><div class="post group">
    <div class="post-content markdown">
      <h3>目标</h3>
<p>我们来把程式在本机启动吧！</p>

<p><br></p>
<h3>步骤</h3>
<h4>步骤 1</h4>
<p>在终端机打这些字：</p>

<p><code>rails server</code></p>

<p><br></p>
<h4>步骤 2</h4>
<p>在你的浏览器打开 <a href="http://localhost:3000" rel="nofollow" target="_blank">http://localhost:3000</a></p>

<p>然后你就会看到的程式跑起来了！</p>

<p><br></p>
<h4>步骤 3</h4>
<p>在终端机里面，server 跑起来的时候，随时按下 Ctrl+C 就可以把 server 关掉。你可以马上试试看。</p>

<p>预期的结果：</p>

<figure class="figure-code code"><div class="highlight"><pre>➜  suggestotron rails s
=&gt; Booting Puma
=&gt; Rails 5.0.0 application starting in development on http://localhost:3000
=&gt; Run `rails server -h` for more startup options
Puma starting in single mode...
* Version 3.4.0 (ruby 2.3.1-p112), codename: Owl Bowl Brawl
* Min threads: 5, max threads: 5
* Environment: development
* Listening on tcp://localhost:3000
Use Ctrl-C to stop
^CExiting
</pre></div>
</figure>

<p><figure><img src="http://ww2.sinaimg.cn/large/006y8lVajw1faqwt0ycoyj30je05zacf.jpg" title=""></figure></p>

<p><br></p>

    </div>
  </div></div><div class='frame'><h1>
      3-4 建立 Migration
    </h1><h4>所属章节：3-初探 Rails</h4><hr><div class="post group">
    <div class="post-content markdown">
      <h3>目标</h3>
<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/KnxmiCxQT2CuweYh6o11_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-10%20%E4%B8%8B%E5%8D%889.58.19.png" title=""></figure></p>

<p>我们的 suggestotron 会有一个 Topics （主题）列表让大家来投票。我们会把 Topics 存进 database 里面。在这一步你会做这些事：</p>

<ul>
<li>在资料库里建立一个简单的“表格（Table）”来储存 Topics，每一篇 Topic 里会有标题和正文内容。</li>
<li>在 Rails 里自动产生相对应的 Scaffold（包含 Model、View、Controller）。</li>
</ul>

<p><br></p>
<h3>步骤</h3>
<h4>步骤 1</h4>
<p>在终端机打这些字：</p>

<p><code>rails generate scaffold topic title:string description:text</code></p>

<ul>
<li>generate scaffold 告诉 Rails 去建立一堆档案让 topics 可以动。</li>
<li>topic 是告诉 rails 新的 Model 的名字是什么。</li>
<li>title:string 是说 topics 有标题（title），它是一个字串（String）。</li>
<li>description:text 是说 topics 有正文内容（description），它是一段文字（Text）。（“字串”跟“文字”的差别？基本上“文字”是用来储存可能会很长的字串。）</li>
</ul>

<p><figure><img src="http://ww4.sinaimg.cn/large/006y8lVajw1faqwp5ocz3j30p9071778.jpg" title=""></figure></p>

<p>你若有兴趣，可以花一点时间研究一下自动产生出来的档案。</p>

<p>补充教材：<a href="https://fullstack.xinshengdaxue.com/posts/49" target="_blank">“Rails 架构”</a></p>

<p><br></p>
<h4>步骤 2</h4>
<p>在终端机打这些字：</p>

<p><code>rake db:migrate</code><br>
<figure><img src="http://ww1.sinaimg.cn/large/006y8lVajw1faqwr419bmj30f803i75g.jpg" title=""></figure></p>

<p>告诉 Rails 更新资料库来建立一个用来储存新的 Model 的表格（Table）。</p>

<p><br></p>

    </div>
  </div></div><div class='frame'><h1>
      3-5 CRUD 和 Scaffolding
    </h1><h4>所属章节：3-初探 Rails</h4><hr><div class="post group">
    <div class="post-content markdown">
      <h3>目标</h3>
<p>大部份基于资料库的网站，其核心都是一样的，都要把资料存起来并且提供方法来做这些事：</p>

<p><strong>C</strong> - 建立（<strong>C</strong>reate）新资料并存进资料库。<br>
<strong>R</strong> - 读取（<strong>R</strong>ead）或显示资料库里的资料。<br>
<strong>U</strong> - 更新（<strong>U</strong>pdate）既有的资料。<br>
<strong>D</strong> - 删除（<strong>D</strong>estroy）资料。</p>

<p>这四个操作（CRUD）常见到 Rails 把它内建到 scaffold 指令里面，我们可以很容易实作出来。</p>

<p><br></p>
<h3>步骤</h3>
<h4>步骤 1</h4>
<p>在浏览器打开 <a href="http://localhost:3000/topics" rel="nofollow" target="_blank">http://localhost:3000/topics</a></p>

<p>你应该会看到一个“Listing Topics”的页面，有个空白但有 Title 和 Description 栏位标题的表格，还有一个连结可以新增 Topic：</p>

<p><figure><img src="http://ww1.sinaimg.cn/large/006y8lVajw1faqwgyvo87j308y06374j.jpg" title=""></figure><br>
<br></p>
<h4>步骤 2</h4>
<ul>
<li>按一下 New Topic</li>
<li>填写表单，然后按一下 Create Topic</li>
<li>你应该会看到一个网页，里面显示你新建立的 topic，并且说你已经成功建立你的 topic 了：</li>
</ul>

<p><figure><img src="http://ww4.sinaimg.cn/large/006y8lVajw1faqwhelurnj309b0810t9.jpg" title=""></figure><br>
<br></p>
<h4>步骤 3</h4>
<ul>
<li>按一下 back</li>
<li>你应该会再看到 topics 列表，这次还有你刚刚新增的 topic：</li>
</ul>

<p><figure><img src="http://ww2.sinaimg.cn/large/006y8lVajw1faqwhrinuaj30dn06tdge.jpg" title=""></figure></p>

<ul>
<li>试试看 show、edit、destroy 连结看看会发生什么事。</li>
<li>贺！你已经建立了一个基本的资料库网站了！</li>
</ul>

<p><br></p>

    </div>
  </div></div><div class='frame'><h1>
      3-6 设定首页
    </h1><h4>所属章节：3-初探 Rails</h4><hr><div class="post group">
    <div class="post-content markdown">
      <h3>目标</h3>
<p>现在结构已经打好了，来把流程变顺畅吧。</p>

<p>现在你打开 <a href="http://localhost:3000" rel="nofollow" target="_blank">http://localhost:3000</a> 的话，你会看到 "Yay! You’re on Rails!" 的字样。</p>

<p>但如果 <a href="http://localhost:3000" rel="nofollow" target="_blank">http://localhost:3000</a> 就可以直接跑到 topics 列表的话，会比较方便。</p>

<p>所以在这一步我们会实现它，并从中学习 Rails 路由（routes）的基本。</p>

<p><br></p>
<h3>步骤</h3>
<h4>步骤 1：加入 root route</h4>
<p>在atom编辑器打开 config/routes.rb, 在 </p>

<figure class="figure-code code"><div class="highlight"><pre>Rails.application.routes.draw do
</pre></div>
</figure> 

<p>下面加一行</p>

<figure class="figure-code code"><div class="highlight"><pre>root "topics#index"
</pre></div>
</figure>

<p>看起来会像这样</p>

<figure class="figure-code code"><figcaption><span>config/routes.rb
</span></figcaption><div class="highlight"><pre><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">routes</span><span class="p">.</span><span class="nf">draw</span> <span class="k">do</span>
  <span class="n">root</span> <span class="s2">"topics#index"</span>
</pre></div>
</figure>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/NbT4a7qnTUeWrreBVuT7_Screenshot%20at%20Mar%2030%2015-24-42.png" title=""></figure></p>

<p>请记得存档（⌘ command + s），修改才会生效。</p>

<p><br></p>
<h4>步骤 2：确认修改成功</h4>
<p>回到 <a href="http://localhost:3000/" rel="nofollow" target="_blank">http://localhost:3000/</a>。你应该会被带到 topics 列表。</p>

<p><figure><img src="http://ww3.sinaimg.cn/large/006y8lVajw1faqw65429tj30dx07naam.jpg" title=""></figure><br>
<br></p>
<h2>部署（Deploying）</h2>
<p>在继续下一步之前，你可以考虑把程式上传到 Heroku！</p>

<p>具体可以参考第一课<a href="https://fullstack.xinshengdaxue.com/posts/932" target="_blank">相关章节</a>以及<a href="http://docs.qzy.camp/docs/heroku" target="_blank">帮助文档</a></p>

    </div>
  </div></div><div class='frame'><h1>
      3-7 对 Topic 投票
    </h1><h4>所属章节：3-初探 Rails</h4><hr><div class="post group">
    <div class="post-content markdown">
      <h3>目标</h3>
<ul>
<li>建立投票的 model</li>
</ul>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/DoNxzxLRsGXvNdjJ1ggt_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-10%20%E4%B8%8B%E5%8D%8810.17.57.png" title=""></figure></p>

<p>Suggestotron 里面的每一个 topic 都可以投票。为了计算票数，我们要有投票记录。来加个 table 吧。</p>

<p><br></p>
<h3>步骤</h3>
<p>在终端机打这些字：</p>

<ul>
<li><code>rails generate model vote topic_id:integer</code></li>
<li><code>rake db:migrate</code></li>
</ul>

<p><figure><img src="http://ww4.sinaimg.cn/large/006y8lVajw1faqw0lq2mrj30lp05076j.jpg" title=""></figure></p>

<p><figure><img src="http://ww2.sinaimg.cn/large/006y8lVajw1faqw1aojs3j30gc03jabb.jpg" title=""></figure><br>
<br></p>

    </div>
  </div></div><div class='frame'><h1>
      3-8 把投票记录和 Topics 接起来
    </h1><h4>所属章节：3-初探 Rails</h4><hr><div class="post group">
    <div class="post-content markdown">
      <h3>目标</h3>
<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/XPaKQENjQ1OBk75V8e4x_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-10%20%E4%B8%8B%E5%8D%8810.20.26.png" title=""></figure></p>

<p>资料库里面有了关联号码，接下来我们要来告诉 Rails，topic 和投票记录之间有明确的关系。</p>

<p><br></p>
<h3>步骤</h3>
<h4>步骤 1：告诉 Topic model 有 Vote（投票记录）的存在</h4>
<p>编辑 app/models/topic.rb 让它长得像这样：</p>

<figure class="figure-code code"><figcaption><span>app/models/topic.rb
</span></figcaption><div class="highlight"><pre><span class="k">class</span> <span class="nc">Topic</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_many</span> <span class="ss">:votes</span><span class="p">,</span> <span class="ss">dependent: :destroy</span>
<span class="k">end</span>
</pre></div>
</figure>

<p><figure><img src="http://ww1.sinaimg.cn/large/006y8lVajw1faqvu2tazdj30lk08idgy.jpg" title=""></figure><br>
<br></p>
<h4>步骤 2：告诉 Vote model 有 Topic 的存在</h4>
<p>编辑 app/models/vote.rb 让它长得像这样：</p>

<figure class="figure-code code"><figcaption><span>app/models/vote.rb
</span></figcaption><div class="highlight"><pre><span class="k">class</span> <span class="nc">Vote</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">belongs_to</span> <span class="ss">:topic</span>
<span class="k">end</span>
</pre></div>
</figure>

<p><figure><img src="http://ww4.sinaimg.cn/large/006y8lVajw1faqvv8wpbzj30lk08iwfh.jpg" title=""></figure><br>
<br></p>
<h4>步骤 3：进 Rails console 随便玩玩看 Topic 和 Vote model</h4>
<p>首先，先确定你已经开了至少一篇 topic。</p>

<p>然后，从终端机视窗进入 Rails console：</p>

<p><code>rails c</code></p>

<p>预期的结果：</p>

<figure class="figure-code code"><div class="highlight"><pre>Running via Spring preloader in process 11071
Loading development environment (Rails 5.0.0)
2.3.1 :001 &gt;
</pre></div>
</figure>

<p>在 console 里面试试看这些指令：</p>

<p>检查总共有多少 topics：</p>

<p>继续在终端输入<code>Topic.count</code></p>

<p>把第一篇 topic 存入变数</p>

<p><code>my_topic = Topic.first</code></p>

<p>my_topic 可以是任何的变数名称，不过现在我们一律用 my_topic。</p>

<p>把那个 topic 的 title 改成别的：</p>

<p><code>my_topic.update_attributes(title: 'Edited in the console')</code></p>

<p>新增一笔投票记录给那个 topic：</p>

<p><code>my_topic.votes.create</code></p>

<p>检查 topic 总共有多少笔投票：</p>

<p><code>my_topic.votes.count</code></p>

<p>删除一笔那个 topic 的投票记录：</p>

<p><code>my_topic.votes.first.destroy</code></p>

<p>最后，记得输入<code>exit</code>退出console。</p>

<p>请注意，你在 <strong>Model class</strong>（例如 <strong>Topic</strong>、<strong>Vote</strong>）和 <strong>Model instance</strong>（例如此例的my_topic）可以做的事是不一样的。my_topic.votes称作 association，在这里的行为比较像是 model class。</p>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/GmS6BOkCRJagJJkU7fx0_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-10%20%E4%B8%8B%E5%8D%8810.27.27.png" title=""></figure></p>

<p>要看完整的列表的话，你可以上 <a href="http://guides.rubyonrails.org/active_record_querying.html" target="_blank">Active Record Query Interface RailsGuide</a></p>

    </div>
  </div></div><div class='frame'><h1>
      3-9 让大家可以投票
    </h1><h4>所属章节：3-初探 Rails</h4><hr><div class="post group">
    <div class="post-content markdown">
      <h3>目标</h3>
<p>现在我们要来加一个按钮，让大家可以按下去就投票加分。</p>

<p><br></p>
<h3>步骤</h3>
<h4>步骤 1：加一个新的 controller action 来投票加分</h4>
<p>编辑 app/controllers/topics_controller.rb 然后把以下这个 method 加在 controller 下方的 private这个keyword 之上：</p>

<figure class="figure-code code"><figcaption><span>app/controllers/topics_controller.rb
</span></figcaption><div class="highlight"><pre><span class="k">def</span> <span class="nf">upvote</span>
  <span class="vi">@topic</span> <span class="o">=</span> <span class="no">Topic</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="vi">@topic</span><span class="p">.</span><span class="nf">votes</span><span class="p">.</span><span class="nf">create</span>
  <span class="n">redirect_to</span><span class="p">(</span><span class="n">topics_path</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</figure>

<p><figure><img src="http://ww1.sinaimg.cn/large/006y8lVajw1faqvl4cxf4j30m60hrn0g.jpg" title=""></figure><br>
<br></p>
<h5>我们来看一下以上代码的具体作用：</h5>
<figure class="figure-code code"><div class="highlight"><pre>@topic = Topic.find(params[:id])
</pre></div>
</figure>

<p>从资料库里面用 id 找到 topic 然后存进 @topic 变数里面。</p>

<figure class="figure-code code"><div class="highlight"><pre>@topic.votes.create
</pre></div>
</figure>

<p>给目前这篇 topic 新增一笔投票记录，然后存进资料库里面。</p>

<figure class="figure-code code"><div class="highlight"><pre>redirect_to(topics_path)
</pre></div>
</figure> 

<p>跟浏览器说要回到 topics_path（topics 的列表）。</p>
<h4>步骤 2：给投票加分操作加一个 route</h4>
<p>打开 config/routes.rb 然后找这个：</p>

<figure class="figure-code code"><figcaption><span>config/routes.rb
</span></figcaption><div class="highlight"><pre><span class="p">.</span><span class="nf">.</span><span class="o">.</span><span class="err">（略）</span>
<span class="n">resources</span> <span class="ss">:topics</span>
<span class="p">.</span><span class="nf">.</span><span class="o">.</span><span class="err">（略）</span>
</pre></div>
</figure>

<p>取代之，让整个档案长得像这样：</p>

<figure class="figure-code code"><figcaption><span>config/routes.rb
</span></figcaption><div class="highlight"><pre><span class="no">Rails</span><span class="p">.</span><span class="nf">application</span><span class="p">.</span><span class="nf">routes</span><span class="p">.</span><span class="nf">draw</span> <span class="k">do</span>
 <span class="n">root</span> <span class="s1">'topics#index'</span>
 <span class="n">resources</span> <span class="ss">:topics</span> <span class="k">do</span>
   <span class="n">member</span> <span class="k">do</span>
     <span class="n">post</span> <span class="s1">'upvote'</span>
   <span class="k">end</span>
 <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</figure>

<p><figure><img src="http://ww3.sinaimg.cn/large/006y8lVajw1faqvm3y8p8j30ln0e1myy.jpg" title=""></figure></p>

<p>现在来检查 route 有成功加入，方法是看一下 <code>rake routes</code> 的输出结果，或是打开 <a href="http://localhost:3000/rails/info" rel="nofollow" target="_blank">http://localhost:3000/rails/info</a>。你应该会看到有一行长得像这样：</p>

<p><figure><img src="http://ww4.sinaimg.cn/large/006tNbRwjw1fawn5a69tjj30uc02m0tv.jpg" title=""></figure></p>

<p><br></p>
<h4>步骤 3：在 view 里面加一个按钮</h4>
<p>编辑 app/views/topics/index.html.erb 让最下面的 loop（回圈）程式码长得像这样：</p>

<figure class="figure-code code"><figcaption><span>app/views/topics/index.html.erb
</span></figcaption><div class="highlight"><pre><span class="cp">&lt;%</span> <span class="vi">@topics</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">topic</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;tr&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">topic</span><span class="p">.</span><span class="nf">title</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">topic</span><span class="p">.</span><span class="nf">description</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">pluralize</span><span class="p">(</span><span class="n">topic</span><span class="p">.</span><span class="nf">votes</span><span class="p">.</span><span class="nf">count</span><span class="p">,</span> <span class="s2">"vote"</span><span class="p">)</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">button_to</span> <span class="s1">'+1'</span><span class="p">,</span> <span class="n">upvote_topic_path</span><span class="p">(</span><span class="n">topic</span><span class="p">),</span> <span class="ss">method: :post</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">'Show'</span><span class="p">,</span> <span class="n">topic</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">'Edit'</span><span class="p">,</span> <span class="n">edit_topic_path</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">'Destroy'</span><span class="p">,</span> <span class="n">topic</span><span class="p">,</span> <span class="ss">method: :delete</span><span class="p">,</span> <span class="ss">data: </span><span class="p">{</span> <span class="ss">confirm: </span><span class="s1">'Are you sure?'</span> <span class="p">}</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
  <span class="nt">&lt;/tr&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</pre></div>
</figure>

<p><figure><img src="http://ww1.sinaimg.cn/large/006y8lVajw1faqvnhnojej30su0lyjwd.jpg" title=""></figure><br>
<br></p>
<h5>我们来看一下以上代码的具体作用：</h5>
<figure class="figure-code code"><div class="highlight"><pre>pluralize(topic.votes.count, "vote") 
</pre></div>
</figure>

<p>会输出票数，并且根据（英文的）单复数在后面加上 'vote' 或 'votes' 单字。</p>

<figure class="figure-code code"><div class="highlight"><pre>button_to '+1' 
</pre></div>
</figure>

<p>加一个 HTML 的按钮（button），里面有字 '+1'。</p>

<figure class="figure-code code"><div class="highlight"><pre>upvote_topic_path(topic)
</pre></div>
</figure> 

<p>产生我们要呼叫的 action 的对应 URL。以此例而言，我们要对目前的 topic 投票加分。它会回传/topics/42/upvote（如 topic.id 是 42）</p>

<figure class="figure-code code"><div class="highlight"><pre>method: :post
</pre></div>
</figure> 

<p>确保我们使用了 CRUD 里面的 create 操作，而非 read。</p>

<p><br></p>
<h4>步骤 4：在浏览器里面检查修改成功</h4>
<p>回到 <a href="http://localhost:3000/topics" rel="nofollow" target="_blank">http://localhost:3000/topics</a> 然后随便玩玩看。</p>

<p>嗯，你发现了吗，Rails程式可以一边运行一边被修改，不用“关闭--修改--重开”，酷吧？</p>

<p><figure><img src="http://ww2.sinaimg.cn/large/006y8lVajw1faqvom2oqlj30h306kwf0.jpg" title=""></figure></p>

<p><br></p>
<h3>部署（Deploying）</h3>
<p>在继续下一步之前，你可以考虑把程式上传到 Heroku！</p>

    </div>
  </div></div><div class='frame'><h1>
      3-10 新增后能够回到 topics 列表
    </h1><h4>所属章节：3-初探 Rails</h4><hr><div class="post group">
    <div class="post-content markdown">
      <p>当使用者建立了一篇新的 topic、或是编辑既有的 topic 的时候，使用者将会看到单独那一篇 topic 的页面。但对于我们的投票程式来说，如果能够回到 topics 列表会更好。</p>

<p>所以在这一步里面我们将会修改程式的流程，让 user 新增（create）topic 或编辑（update）topic 之后可以回到 topics 列表。</p>

<p><br></p>
<h3>步骤</h3>
<h4>步骤 1：修改 topics controller</h4>
<p>打开 app/controllers/topics_controller.rb 找到 create method。</p>

<p>找这一行：</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre>format.html { redirect_to @topic, notice: 'Topic was successfully created.' }
</pre></div>
</figure>

<p>把 @topic 改成 topics_path，像这样：</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre>format.html { redirect_to topics_path, notice: 'Topic was successfully created.' }
</pre></div>
</figure>

<p>最后会长得像这样：</p>

<figure class="figure-code code"><figcaption><span>app/controllers/topics_controller.rb
</span></figcaption><div class="highlight"><pre>
<span class="k">def</span> <span class="nf">create</span>
  <span class="vi">@topic</span> <span class="o">=</span> <span class="no">Topic</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">topic_params</span><span class="p">)</span>

  <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
    <span class="k">if</span> <span class="vi">@topic</span><span class="p">.</span><span class="nf">save</span>
      <span class="nb">format</span><span class="p">.</span><span class="nf">html</span> <span class="p">{</span> <span class="n">redirect_to</span> <span class="n">topics_path</span><span class="p">,</span> <span class="ss">notice: </span><span class="s1">'Topic was successfully created.'</span> <span class="p">}</span>
      <span class="nb">format</span><span class="p">.</span><span class="nf">json</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">:show</span><span class="p">,</span> <span class="ss">status: :created</span><span class="p">,</span> <span class="ss">location: </span><span class="vi">@topic</span> <span class="p">}</span>
    <span class="k">else</span>
      <span class="nb">format</span><span class="p">.</span><span class="nf">html</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">:new</span> <span class="p">}</span>
      <span class="nb">format</span><span class="p">.</span><span class="nf">json</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">json: </span><span class="vi">@topic</span><span class="p">.</span><span class="nf">errors</span><span class="p">,</span> <span class="ss">status: :unprocessable_entity</span> <span class="p">}</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</figure>

<p><figure><img src="http://ww3.sinaimg.cn/large/006y8lVajw1faqvgwkj2dj30q20dzgom.jpg" title=""></figure></p>

<p>在同一个档案里面，找到 update method。</p>

<p>找这一行：</p>

<figure class="figure-code code"><div class="highlight"><pre>format.html { redirect_to @topic, notice: 'Topic was successfully updated.' }
</pre></div>
</figure>

<p>跟之前一样，把 @topic 改成 topics_path：</p>

<figure class="figure-code code"><div class="highlight"><pre>format.html { redirect_to topics_path, notice: 'Topic was successfully updated.' }
</pre></div>
</figure>

<p><figure><img src="http://ww1.sinaimg.cn/large/006y8lVajw1faqvisd3gzj30nx0dzju8.jpg" title=""></figure></p>

<p><br></p>
<h4>步骤 2：确认修改成功</h4>
<p>打开 <a href="http://localhost:3000/topics" rel="nofollow" target="_blank">http://localhost:3000/topics</a> 然后玩玩看。</p>

<p><br></p>

    </div>
  </div></div><div class='frame'><h1>
       3-11 把 Topic 标题变成可以点选的超连结
    </h1><h4>所属章节：3-初探 Rails</h4><hr><div class="post group">
    <div class="post-content markdown">
      <h3>目标</h3>
<p>你朋友建议你把网站修改以下2个地方，看起来会更好：</p>

<ul>
<li>不要在 topics 列表页面出现正文内容。</li>
<li>把 topics 变成超链接，使用者必须点击 topics 才会显示正文内容。</li>
</ul>

<p><br></p>
<h3>步骤</h3>
<h4>步骤 1：拿掉正文内容</h4>
<p>首先来拿掉正文内容（description）吧。打开 app/views/topics/index.html.erb 然后删掉这一行：</p>

<figure class="figure-code code"><figcaption><span>app/views/topics/index.html.erb
</span></figcaption><div class="highlight"><pre><span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">topic</span><span class="p">.</span><span class="nf">description</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
</pre></div>
</figure>

<p>也删掉这一行</p>

<figure class="figure-code code"><figcaption><span>app/views/topics/index.html.erb
</span></figcaption><div class="highlight"><pre><span class="nt">&lt;th&gt;</span>Description<span class="nt">&lt;/th&gt;</span>
</pre></div>
</figure>

<p><figure><img src="http://ww2.sinaimg.cn/large/006y8lVajw1faqvcpjvztj30pq0k6jvr.jpg" title=""></figure></p>

<p>现在可以试试看在浏览器里面重新刷新，你应该会发现正文内容消失了。<br>
<br></p>
<h4>步骤 2：把标题变成超连结</h4>
<p>现在来把标题变成超链接，编辑 app/views/topics/index.html.erb 然后把这一行：</p>

<figure class="figure-code code"><figcaption><span>app/views/topics/index.html.erb
</span></figcaption><div class="highlight"><pre><span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">topic</span><span class="p">.</span><span class="nf">title</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
</pre></div>
</figure>

<p>改成这样：</p>

<figure class="figure-code code"><figcaption><span>app/views/topics/index.html.erb
</span></figcaption><div class="highlight"><pre><span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="n">topic</span><span class="p">.</span><span class="nf">title</span><span class="p">,</span> <span class="n">topic</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
</pre></div>
</figure>

<p><figure><img src="http://ww4.sinaimg.cn/large/006y8lVajw1faqvdhn4d9j30qr08sgnl.jpg" title=""></figure></p>

<p><br></p>

    </div>
  </div></div><div class='frame'><h1>
      3-12 清理 Topics 列表
    </h1><h4>所属章节：3-初探 Rails</h4><hr><div class="post group">
    <div class="post-content markdown">
      <h3>目标</h3>
<p>我们的程式快要完成了！topics 列表页看起来很冗。其实有一些连结是无用的。<br>
来清理一下吧：</p>

<ul>
<li>拿掉 show 超连结。</li>
<li>拿掉 edit 超连结。</li>
<li>把 destroy改成 delete。</li>
</ul>

<p><br></p>
<h3>步骤</h3>
<h4>步骤 1：拿掉 show 和 edit 超连结</h4>
<p>打开 app/views/topics/index.html.erb 删除这两行：</p>

<figure class="figure-code code"><figcaption><span>app/views/topics/index.html.erb
</span></figcaption><div class="highlight"><pre><span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">'Show'</span><span class="p">,</span> <span class="n">topic</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
<span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">'Edit'</span><span class="p">,</span> <span class="n">edit_topic_path</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
</pre></div>
</figure>

<p><br></p>
<h4>步骤 2：把 destroy 改成 delete</h4>
<p>把有 Destroy 字样的那一行修改成这样：</p>

<figure class="figure-code code"><figcaption><span>app/views/topics/index.html.erb
</span></figcaption><div class="highlight"><pre><span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s1">'Delete'</span><span class="p">,</span> <span class="n">topic</span><span class="p">,</span> <span class="ss">method: :delete</span><span class="p">,</span> <span class="ss">data: </span><span class="p">{</span> <span class="ss">confirm: </span><span class="s1">'Are you sure?'</span> <span class="p">}</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
</pre></div>
</figure>

<p><figure><img src="http://ww3.sinaimg.cn/large/006y8lVajw1faqva53w8ej30ry0bpmzy.jpg" title=""></figure><br>
<br></p>
<h4>步骤 3：确认修改成功</h4>
<p>存档，然后重新刷新浏览器，看看修改有没有成功。</p>

<p><br></p>

    </div>
  </div></div><div class='frame'><h1>
      3-13 加分题 &amp; 下一步
    </h1><h4>所属章节：3-初探 Rails</h4><hr><div class="post group">
    <div class="post-content markdown">
      <h3>请做完第三课中级练习的同学再回来做</h3>
<p>此题如在 Slack 求助，需展示第三课的作业完成链接</p>
<h3>加分题</h3>
<p>如果你完成了 Suggestotron 而还剩下一些时间，你可以试试看这些：</p>

<ul>
<li>加一个“扣分”按钮，做的事跟加分按钮相反。</li>
<li>根据投票分数排序 topics。</li>
<li>新增一个 'about' 页面，并将连结放在 topics 列表的最下方。记得也要在 About 页面上放置回 Topics 列表的连结，以免使用者迷路。</li>
</ul>

    </div>
  </div></div><div class='frame'><h1>
      3-14 贺！你刚“完成”了你的第一个 Rails 程式！
    </h1><h4>所属章节：3-初探 Rails</h4><hr><div class="post group">
    <div class="post-content markdown">
      <p>你知道吗？你<strong>做完了</strong>！！！<br>
贺！你刚“完成”了你的第一个 Rails 程式！</p>

<p><br></p>
<h3>接下来你可以进到：Rails101</h3>
    </div>
  </div></div><div class='frame'><h1>
      4-1 补充教材：Rails 架构
    </h1><h4>所属章节：4-补充教材</h4><hr><div class="post group">
    <div class="post-content markdown">
      <h2>目标</h2>
<p>做一个资料库表格来储存 topic，topic 有 title 和 description。</p>

<p>在这一步我们会学一点 Rails 的架构。最终你应该会了解这些观念：</p>

<ul>
<li>Table</li>
<li>Model</li>
<li>View</li>
<li>Controller</li>
</ul>

<p><br></p>
<h2>解说</h2>
<h3>Rails 的架构以及它与资料库的关联</h3>
<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/2aFSZZRQKei3eSroobFg_%E8%9E%A2%E5%B9%95%E5%BF%AB%E7%85%A7%202016-07-10%20%E4%B8%8B%E5%8D%8811.14.22.png" title=""></figure></p>

<p>Rails 把 <strong>Model/View/Controller</strong> 的设计模式实作得非常具体，来指引你如何设计你的网路应用程式。</p>

<p><br></p>
<h4>Model</h4>
<ul>
<li>我们在 RailsBridge 建立的 Model，其每一个 Model object 都在资料库里面有对应的资料。资料库里面的表格（table）是 Model 的 class name 的复数形。例如，如果 Model 叫做 'Duck'，就会自动去资料库读写 'ducks' 这个表格。</li>
<li>Rails 内部的 methods 让我们可以很容易把资料写入到资料库，之后再从资料库里面查询（query）出来。</li>
<li>Model 是介于资料库和你的程式码之间的桥梁。</li>
</ul>

<p><br></p>
<h4>View</h4>
<ul>
<li>View 会产生 HTML 来显示在浏览器。</li>
<li>View 档案是用 ERB 写的，它是一种样板语言（Template Language）。里面是 HTML 加上内嵌的 Ruby 程式码。View 里面的 Ruby 的变数便是当使用者要浏览该页面的时候，所要填入的内容。</li>
<li>（还有别的样板语言，但是在 RailsBridge 我们只用 ERB。）</li>
</ul>

<p><br></p>
<h4>Controller</h4>
<ul>
<li>Controller 把 Ruby 的 objects 在 Model 和 View 之间传来传去。</li>
<li>每一个 URL 都对应到 Controller 里面的某一个特定的 method。</li>
<li>在这一步骤以后，当你打开你应用程式里面的任何一个页面，该请求（request）会被某个 Controller 的 method 
处理。</li>
</ul>

<p>当我们把 Models、Views、Controllers 放在一起的时候，他们会遵循以下的模式：</p>

<p>给一个 URL，Rails 会去检查要使用哪一个 Controller 里面的 method（又称为 "Action"）。Controller Action 会去呼叫 Model 里面对应的 methods。Model 会去读写资料库，然后把包含资料的 object 回传到 Controller。Controller 会拿到这个 object 并且丢到 View 里面。Action 通常会有对应的 View 档案，Rails 会自动寻找并使用之。）</p>

<p>Models、Views、Controllers 有各自的工作。像这样把责任拆开来，会比较容易开发，尤其是它长得愈来愈大的时候。（每个档案都有清晰的责任，会比较容易处理问题、增加新功能。）</p>

<p>如果你想要学更多 Rails 架构的话，你可以看一下这个教学影片（三分半钟）<a href="https://www.youtube.com/watch?v=eTdVkgF_Slo" target="_blank">“MVC 架构 YouTube”</a></p>

<p><br></p>
<h4>补充</h4>
<p>换个方式说说 MVC</p>

<p><figure><img src="https://s3-ap-northeast-1.amazonaws.com/ontrackapp-production/q7vmo1xSQw6vRT4hUSu9_Screenshot%20at%20Mar%2029%2015-48-32.png" title=""></figure></p>

<p>从这张图可以更明白， controller 就是手把的摇杆去操控 model 后把画面给 view 显示。</p>

<p>那么这边指的 model 就相当于游戏的逻辑啰，不同的游戏就载入不同的逻辑，以玛利欧游戏来说， model 里面就存放的关卡的讯息，包含有多少怪物、关卡可以获得多少金币等等… 当你破关的时候，就会在 model 里面去更新你的讯息了，这样下次就会知道哪些关卡已经突破，哪些还尚未闯关，如此一来，你就可以用 controller 选择下一关继续闯关了，这时候 view 就会显示新的关卡了。</p>

    </div>
  </div></div><div class='end'>
              <a href='https://fullstack.qzy.camp/'>
                <img src='https://img.buzzfeed.com/buzzfeed-static/static/2014-10/26/6/enhanced/webdr08/longform-original-14836-1414320930-10.jpg'>
              </a>
              <p>The End</p>
            </div>